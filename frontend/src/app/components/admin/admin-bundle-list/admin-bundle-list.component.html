<div class="admin-page">
  <div class="header-section mb-5">
    <div>
      <h1 class="text-3xl font-bold text-white mb-2">Gerenciar Bundles</h1>
      <p class="text-gray-400">Organize os materiais de estudo semanais.</p>
    </div>
    <div class="flex gap-2">
      <button
        pButton
        label="Novo Bundle"
        icon="pi pi-plus"
        routerLink="/admin/bundles/new"
        class="custom-button-primary"
      ></button>
    </div>
  </div>

  <div class="card p-0 overflow-hidden bg-dark-card border-gray-700">
    <p-table
      [value]="(bundles$ | async) || []"
      dataKey="id"
      responsiveLayout="scroll"
      [tableStyle]="{ 'min-width': '50rem' }"
      styleClass="p-datatable-sm custom-table"
    >
      <ng-template pTemplate="header">
        <tr>
          <th class="text-gold">Título</th>
          <th class="text-gold">Trimestre</th>
          <th class="text-gold">Lição #</th>
          <th class="text-gold">Links</th>
          <th class="text-gold text-right">Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-bundle>
        <tr class="hover:bg-gray-800 transition-colors">
          <td class="text-white font-medium">{{ bundle.title }}</td>
          <td class="text-gray-300">{{ bundle.trimester }}</td>
          <td class="text-gray-300">{{ bundle.lesson_number }}</td>
          <td class="text-gray-300">
            <a
              *ngIf="bundle.youtube_link"
              [href]="bundle.youtube_link"
              target="_blank"
              class="text-gold mr-2"
              ><i class="pi pi-youtube"></i
            ></a>
            <a
              *ngIf="bundle.article_link"
              [href]="bundle.article_link"
              target="_blank"
              class="text-blue-400"
              ><i class="pi pi-link"></i
            ></a>
          </td>
          <td class="text-right">
            <button
              pButton
              icon="pi pi-pencil"
              class="p-button-text p-button-rounded text-gold hover:bg-gray-700"
              [routerLink]="['/admin/bundles', bundle.id]"
              pTooltip="Editar"
            ></button>
            <button
              pButton
              icon="pi pi-trash"
              class="p-button-text p-button-rounded text-red-400 hover:bg-gray-700"
              (click)="deleteBundle(bundle.id)"
              pTooltip="Excluir"
            ></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center p-4 text-gray-400">
            Nenhum bundle encontrado. Clique em "Novo Bundle" para começar.
            <div *ngIf="error" class="text-red-400 mt-2">Erro ao carregar: {{ error }}</div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
